// 絵文字辞書
const emojiDictionary = {
    // === 感情系 ===
    // ポジティブ感情
    '嬉しい': '😊', '幸せ': '😊', '喜び': '😄', '笑顔': '😊', '笑い': '😄', '爆笑': '🤣',
    '楽しい': '😄', '面白い': '😆', 'ワクワク': '🤗', '興奮': '😆', '満足': '😌',
    '愛': '❤️', '恋': '💕', 'ラブ': '💖', '好き': '💖', '恋人': '💑', 'キス': '💋',
    '感動': '🥺', '感激': '🥺', '感謝': '🙏', 'ありがとう': '🙏', '尊敬': '😌',
    
    // ネガティブ感情
    '悲しい': '😢', '哀しい': '😢', '泣く': '😭', '涙': '😭', '寂しい': '😔', '切ない': '😢',
    '憂鬱': '😞', 'うつ': '😞', 'ブルー': '😔', '失望': '😞', 'がっかり': '😞',
    '怒り': '😠', '怒る': '😠', '激怒': '😡', 'むかつく': '😠', 'イライラ': '😤', '腹立つ': '😠',
    '驚き': '😮', '驚く': '😲', 'びっくり': '😲', 'ショック': '😱', '仰天': '😲',
    '恐怖': '😨', '怖い': '😨', 'こわい': '😨', '恐ろしい': '😱', '不安': '😰', '心配': '😟',
    '恥ずかしい': '😳', '照れる': '😊', '赤面': '😳', '困惑': '😵', '混乱': '😵‍💫',
    
    // 状態・体調
    '眠い': '😴', '眠る': '😴', '寝る': '😴', '疲れ': '😴', 'だるい': '😪', '眠気': '😪',
    '考える': '🤔', '思考': '🤔', '悩む': '🤔', '迷う': '🤔', '集中': '🧐',
    '困る': '😅', '困った': '😅', '汗': '😅', '焦る': '😰', 'ピンチ': '😰',
    '安心': '😌', 'ほっと': '😌', 'リラックス': '😌', '平和': '😌', '穏やか': '😌',
    '病気': '🤒', '風邪': '🤧', '熱': '🤒', '頭痛': '🤕', '具合悪い': '😷',
    
    // === 天気系 ===
    '晴れ': '☀️', '晴天': '☀️', '太陽': '☀️', '日光': '☀️', '快晴': '☀️',
    '暑い': '🌞', '猛暑': '🥵', '灼熱': '🥵', '夏': '🌞', '真夏': '🌞',
    '雨': '🌧️', '雨天': '🌧️', '降雨': '🌧️', '雨降り': '🌧️', '小雨': '🌦️',
    '大雨': '⛈️', '豪雨': '⛈️', '梅雨': '🌧️', '夕立': '🌦️', 'にわか雨': '🌦️',
    '雪': '❄️', '雪降り': '⛄', '大雪': '🌨️', '吹雪': '🌨️', '雪だるま': '⛄',
    '冬': '❄️', '寒い': '🥶', '極寒': '🥶', '氷': '🧊', '霜': '❄️',
    '曇り': '☁️', '雲': '☁️', '曇天': '☁️', '厚い雲': '☁️', '薄曇り': '⛅',
    '嵐': '⛈️', '雷': '⚡', '雷雨': '⛈️', '台風': '🌪️', '竜巻': '🌪️',
    '風': '💨', '強風': '💨', '突風': '💨', '微風': '🍃', 'そよ風': '🍃',
    '虹': '🌈', 'にじ': '🌈', '霧': '🌫️', 'きり': '🌫️', 'もや': '🌫️',
    '春': '🌸', '秋': '🍂', '季節': '🌤️', '気候': '🌤️',
    
    // === 動物系 ===
    // ペット・身近な動物
    '犬': '🐕', 'いぬ': '🐕', 'イヌ': '🐕', '子犬': '🐶', 'わんちゃん': '🐶', 'ワンワン': '🐕',
    '猫': '🐱', 'ねこ': '🐱', 'ネコ': '🐱', '子猫': '🐱', 'にゃんこ': '🐱', 'ニャンニャン': '🐱',
    'ハムスター': '🐹', 'うさぎ': '🐰', 'ウサギ': '🐰', 'ラビット': '🐰',
    
    // 鳥類
    '鳥': '🐦', 'とり': '🐦', '小鳥': '🐦', '鶏': '🐔', 'にわとり': '🐔',
    'ひよこ': '🐤', 'ヒヨコ': '🐤', 'ペンギン': '🐧', 'フクロウ': '🦉',
    '鷲': '🦅', 'わし': '🦅', '鳩': '🕊️', 'はと': '🕊️', '白鳥': '🦢',
    
    // 海洋生物
    '魚': '🐟', 'さかな': '🐟', '金魚': '🐠', 'きんぎょ': '🐠',
    'クジラ': '🐋', 'くじら': '🐋', 'イルカ': '🐬', 'いるか': '🐬',
    'サメ': '🦈', 'さめ': '🦈', 'タコ': '🐙', 'たこ': '🐙',
    'エビ': '🦐', 'えび': '🦐', 'カニ': '🦀', 'かに': '🦀',
    
    // 野生動物・大型動物
    '象': '🐘', 'ゾウ': '🐘', 'キリン': '🦒', 'きりん': '🦒',
    'ライオン': '🦁', 'らいおん': '🦁', 'トラ': '🐅', 'とら': '🐅',
    '熊': '🐻', 'クマ': '🐻', 'くま': '🐻', 'パンダ': '🐼', 'ぱんだ': '🐼',
    'コアラ': '🐨', 'こあら': '🐨', 'カンガルー': '🦘', 'かんがるー': '🦘',
    '猿': '🐵', 'さる': '🐵', 'サル': '🐵', 'ゴリラ': '🦍', 'ごりら': '🦍',
    
    // 家畜・農場動物
    '馬': '🐎', 'うま': '🐎', 'ウマ': '🐎', '牛': '🐄', 'うし': '🐄',
    '豚': '🐷', 'ぶた': '🐷', 'ブタ': '🐷', '羊': '🐑', 'ひつじ': '🐑',
    'ヤギ': '🐐', 'やぎ': '🐐', 'アヒル': '🦆', 'あひる': '🦆',
    
    // 昆虫・小動物
    '蝶': '🦋', 'ちょう': '🦋', 'チョウ': '🦋', '蜂': '🐝', 'はち': '🐝',
    'てんとう虫': '🐞', 'テントウムシ': '🐞', 'アリ': '🐜', 'あり': '🐜',
    'クモ': '🕷️', 'くも': '🕷️', 'カタツムリ': '🐌', 'かたつむり': '🐌',
    
    // 爬虫類・両生類
    '蛇': '🐍', 'へび': '🐍', 'ヘビ': '🐍', 'トカゲ': '🦎', 'とかげ': '🦎',
    'カメ': '🐢', 'かめ': '🐢', 'ウミガメ': '🐢', 'うみがめ': '🐢',
    'カエル': '🐸', 'かえる': '🐸', 'ワニ': '🐊', 'わに': '🐊',
    
    // === 食べ物系 ===
    // 果物
    'りんご': '🍎', 'リンゴ': '🍎', 'バナナ': '🍌', 'みかん': '🍊', 'オレンジ': '🍊',
    'いちご': '🍓', 'イチゴ': '🍓', 'さくらんぼ': '🍒', 'チェリー': '🍒',
    'ぶどう': '🍇', 'ブドウ': '🍇', 'もも': '🍑', 'モモ': '🍑', '桃': '🍑',
    'レモン': '🍋', 'れもん': '🍋', 'メロン': '🍈', 'めろん': '🍈',
    'スイカ': '🍉', 'すいか': '🍉', 'パイナップル': '🍍', 'ぱいなっぷる': '🍍',
    'キウイ': '🥝', 'きうい': '🥝', 'マンゴー': '🥭', 'まんごー': '🥭',
    
    // 主食・パン類
    'パン': '🍞', 'ぱん': '🍞', '食パン': '🍞', 'トースト': '🍞',
    'サンドイッチ': '🥪', 'ハンバーガー': '🍔', 'ホットドッグ': '🌭',
    'ご飯': '🍚', 'お米': '🍚', 'おにぎり': '🍙', 'おむすび': '🍙',
    'パスタ': '🍝', 'スパゲッティ': '🍝', 'うどん': '🍜', 'そば': '🍜',
    
    // 和食
    '寿司': '🍣', 'すし': '🍣', '刺身': '🍣', 'さしみ': '🍣',
    '天ぷら': '🍤', 'てんぷら': '🍤', 'エビフライ': '🍤', 'えびふらい': '🍤',
    '焼き鳥': '🍗', 'やきとり': '🍗', '唐揚げ': '🍗', 'からあげ': '🍗',
    '味噌汁': '🍜', 'みそしる': '🍜', '団子': '🍡', 'だんご': '🍡',
    'おでん': '🍢', 'お好み焼き': '🥞', 'おこのみやき': '🥞',
    
    // 洋食・中華
    'ラーメン': '🍜', 'らーめん': '🍜', '餃子': '🥟', 'ぎょうざ': '🥟',
    'カレー': '🍛', 'かれー': '🍛', 'シチュー': '🍲', 'しちゅー': '🍲',
    'ピザ': '🍕', 'ぴざ': '🍕', 'オムライス': '🍳', 'おむらいす': '🍳',
    'ステーキ': '🥩', 'すてーき': '🥩', '肉': '🍖', 'にく': '🍖',
    'サラダ': '🥗', 'さらだ': '🥗', 'スープ': '🍲', 'すーぷ': '🍲',
    
    // デザート・お菓子
    'ケーキ': '🍰', 'けーき': '🍰', 'ショートケーキ': '🍰', 'しょーとけーき': '🍰',
    'アイス': '🍦', 'あいす': '🍦', 'アイスクリーム': '🍦', 'あいすくりーむ': '🍦',
    'プリン': '🍮', 'ぷりん': '🍮', 'ドーナツ': '🍩', 'どーなつ': '🍩',
    'チョコ': '🍫', 'チョコレート': '🍫', 'ちょこれーと': '🍫',
    'キャンディ': '🍬', 'きゃんでぃ': '🍬', '飴': '🍬', 'あめ': '🍬',
    'クッキー': '🍪', 'くっきー': '🍪', 'ビスケット': '🍪', 'びすけっと': '🍪',
    'パイ': '🥧', 'ぱい': '🥧', 'タルト': '🥧', 'たると': '🥧',
    
    // 飲み物
    'コーヒー': '☕', 'こーひー': '☕', 'カフェ': '☕', 'かふぇ': '☕',
    'お茶': '🍵', 'おちゃ': '🍵', '緑茶': '🍵', 'りょくちゃ': '🍵',
    '紅茶': '🫖', 'こうちゃ': '🫖', 'ウーロン茶': '🍵', 'うーろんちゃ': '🍵',
    '牛乳': '🥛', 'ぎゅうにゅう': '🥛', 'ミルク': '🥛', 'みるく': '🥛',
    'ジュース': '🧃', 'じゅーす': '🧃', 'オレンジジュース': '🧃', 'おれんじじゅーす': '🧃',
    '水': '💧', 'みず': '💧', 'お水': '💧', 'おみず': '💧',
    'ビール': '🍺', 'びーる': '🍺', 'ワイン': '🍷', 'わいん': '🍷',
    '日本酒': '🍶', 'にほんしゅ': '🍶', 'お酒': '🍶', 'おさけ': '🍶',
    'カクテル': '🍸', 'かくてる': '🍸', 'シャンパン': '🍾', 'しゃんぱん': '🍾',
    
    // === 自然系 ===
    // 地形・景観
    '山': '⛰️', 'やま': '⛰️', '富士山': '🗻', '高原': '⛰️', 'こうげん': '⛰️',
    '丘': '🏔️', 'おか': '🏔️', '谷': '🏔️', 'たに': '🏔️', '峠': '⛰️', 'とうげ': '⛰️',
    '海': '🌊', 'うみ': '🌊', '波': '🌊', 'なみ': '🌊', '津波': '🌊', 'つなみ': '🌊',
    '島': '🏝️', 'しま': '🏝️', '砂浜': '🏖️', 'すなはま': '🏖️', 'ビーチ': '🏖️', 'びーち': '🏖️',
    '川': '🏞️', 'かわ': '🏞️', '河': '🏞️', '滝': '💧', 'たき': '💧',
    '湖': '🏞️', 'みずうみ': '🏞️', '池': '🏞️', 'いけ': '🏞️',
    '砂漠': '🏜️', 'さばく': '🏜️', '岩': '🪨', 'いわ': '🪨', '石': '🪨', 'いし': '🪨',
    
    // 植物
    '花': '🌸', 'はな': '🌸', '桜': '🌸', 'さくら': '🌸', 'お花見': '🌸', 'おはなみ': '🌸',
    'バラ': '🌹', 'ばら': '🌹', 'ひまわり': '🌻', 'ヒマワリ': '🌻', '向日葵': '🌻',
    'チューリップ': '🌷', 'ちゅーりっぷ': '🌷', '菊': '🌼', 'きく': '🌼',
    '木': '🌳', 'き': '🌳', '大木': '🌳', 'たいぼく': '🌳', '巨木': '🌳', 'きょぼく': '🌳',
    '森': '🌲', 'もり': '🌲', '林': '🌲', 'はやし': '🌲', 'ジャングル': '🌴', 'じゃんぐる': '🌴',
    '草': '🌱', 'くさ': '🌱', '芝生': '🌱', 'しばふ': '🌱', 'クローバー': '🍀', 'くろーばー': '🍀',
    '葉': '🍃', 'はっぱ': '🍃', '紅葉': '🍂', 'こうよう': '🍂', 'もみじ': '🍂',
    'たけのこ': '🎋', 'タケノコ': '🎋', '竹': '🎋', 'たけ': '🎋',
    
    // 天体・宇宙
    '星': '⭐', 'ほし': '⭐', '恒星': '⭐', 'こうせい': '⭐', '流れ星': '🌠', 'ながれぼし': '🌠',
    '月': '🌙', 'つき': '🌙', '満月': '🌕', 'まんげつ': '🌕', '新月': '🌑', 'しんげつ': '🌑',
    '三日月': '🌙', 'みかづき': '🌙', '半月': '🌓', 'はんげつ': '🌓',
    '地球': '🌍', 'ちきゅう': '🌍', '宇宙': '🌌', 'うちゅう': '🌌', '銀河': '🌌', 'ぎんが': '🌌',
    '太陽系': '🌞', 'たいようけい': '🌞', '惑星': '🪐', 'わくせい': '🪐',
    
    // 自然現象・元素
    '火': '🔥', 'ひ': '🔥', '炎': '🔥', 'ほのお': '🔥', '火事': '🔥', 'かじ': '🔥',
    '水': '💧', 'みず': '💧', '雫': '💧', 'しずく': '💧', '露': '💧', 'つゆ': '💧',
    '土': '🌱', 'つち': '🌱', '砂': '🏖️', 'すな': '🏖️', '泥': '🌱', 'どろ': '🌱',
    
    // === イベント・お祝い系 ===
    'お祝い': '🎉', '祝い': '🎉', 'パーティー': '🎉', 'ぱーてぃー': '🎉',
    '誕生日': '🎂', 'たんじょうび': '🎂', 'バースデー': '🎂', 'ばーすでー': '🎂',
    '結婚式': '💒', 'けっこんしき': '💒', 'ウェディング': '💒', 'うぇでぃんぐ': '💒',
    '卒業': '🎓', 'そつぎょう': '🎓', '入学': '🎓', 'にゅうがく': '🎓',
    'クリスマス': '🎄', 'くりすます': '🎄', 'お正月': '🎍', 'おしょうがつ': '🎍',
    '新年': '🎍', 'しんねん': '🎍', 'ハロウィン': '🎃', 'はろうぃん': '🎃',
    '花火': '🎆', 'はなび': '🎆', '祭り': '🎪', 'まつり': '🎪', 'お祭り': '🎪', 'おまつり': '🎪',
    'プレゼント': '🎁', 'ぷれぜんと': '🎁', 'ギフト': '🎁', 'ぎふと': '🎁',
    '記念日': '🎊', 'きねんび': '🎊', 'お疲れ様': '🎉', 'おつかれさま': '🎉',
    
    // === 行動・活動系 ===
    // スポーツ
    'サッカー': '⚽', 'さっかー': '⚽', 'バスケ': '🏀', 'ばすけ': '🏀',
    '野球': '⚾', 'やきゅう': '⚾', 'テニス': '🎾', 'てにす': '🎾',
    '卓球': '🏓', 'たっきゅう': '🏓', 'バレー': '🏐', 'ばれー': '🏐',
    'ゴルフ': '⛳', 'ごるふ': '⛳', 'スキー': '🎿', 'すきー': '🎿',
    'スノボ': '🏂', 'すのぼ': '🏂', 'スノーボード': '🏂', 'すのーぼーど': '🏂',
    
    // 運動・体の動き
    '走る': '🏃', 'はしる': '🏃', 'ランニング': '🏃', 'らんにんぐ': '🏃',
    '歩く': '🚶', 'あるく': '🚶', '散歩': '🚶', 'さんぽ': '🚶',
    '泳ぐ': '🏊', 'およぐ': '🏊', 'スイミング': '🏊', 'すいみんぐ': '🏊',
    '踊る': '💃', 'おどる': '💃', 'ダンス': '💃', 'だんす': '💃',
    'ヨガ': '🧘', 'よが': '🧘', '筋トレ': '💪', 'きんとれ': '💪',
    'ジム': '🏋️', 'じむ': '🏋️', 'トレーニング': '🏋️', 'とれーにんぐ': '🏋️',
    
    // 学習・仕事
    '勉強': '📚', 'べんきょう': '📚', '学習': '📚', 'がくしゅう': '📚',
    '読書': '📖', 'どくしょ': '📖', '本を読む': '📖', 'ほんをよむ': '📖',
    '仕事': '💼', 'しごと': '💼', '働く': '💼', 'はたらく': '💼',
    '会議': '👥', 'かいぎ': '👥', 'ミーティング': '👥', 'みーてぃんぐ': '👥',
    '試験': '📝', 'しけん': '📝', 'テスト': '📝', 'てすと': '📝',
    '宿題': '📝', 'しゅくだい': '📝', '課題': '📝', 'かだい': '📝',
    
    // 日常行動
    '料理': '🍳', 'りょうり': '🍳', '掃除': '🧹', 'そうじ': '🧹',
    '洗濯': '👕', 'せんたく': '👕', '買い物': '🛒', 'かいもの': '🛒',
    'ショッピング': '🛒', 'しょっぴんぐ': '🛒', '旅行': '✈️', 'りょこう': '✈️',
    '温泉': '♨️', 'おんせん': '♨️', 'キャンプ': '⛺', 'きゃんぷ': '⛺',
    'ピクニック': '🧺', 'ぴくにっく': '🧺', 'ドライブ': '🚗', 'どらいぶ': '🚗',
    
    // 娯楽・エンターテイメント
    'ゲーム': '🎮', 'げーむ': '🎮', '映画': '🎬', 'えいが': '🎬',
    '音楽': '🎵', 'おんがく': '🎵', 'カラオケ': '🎤', 'からおけ': '🎤',
    'コンサート': '🎼', 'こんさーと': '🎼', 'ライブ': '🎤', 'らいぶ': '🎤',
    'テレビ': '📺', 'てれび': '📺', 'アニメ': '📺', 'あにめ': '📺',
    '写真': '📷', 'しゃしん': '📷', '撮影': '📷', 'さつえい': '📷',
    
    // === 建物・場所系 ===
    '家': '🏠', 'いえ': '🏠', '実家': '🏠', 'じっか': '🏠',
    '学校': '🏫', 'がっこう': '🏫', '大学': '🏫', 'だいがく': '🏫',
    '病院': '🏥', 'びょういん': '🏥', '薬局': '💊', 'やっきょく': '💊',
    '会社': '🏢', 'かいしゃ': '🏢', 'オフィス': '🏢', 'おふぃす': '🏢',
    'ホテル': '🏨', 'ほてる': '🏨', '旅館': '🏨', 'りょかん': '🏨',
    '城': '🏰', 'しろ': '🏰', 'お城': '🏰', 'おしろ': '🏰',
    '駅': '🚉', 'えき': '🚉', '空港': '🛫', 'くうこう': '🛫',
    '銀行': '🏦', 'ぎんこう': '🏦', '郵便局': '🏤', 'ゆうびんきょく': '🏤',
    'コンビニ': '🏪', 'こんびに': '🏪', 'スーパー': '🏬', 'すーぱー': '🏬',
    'レストラン': '🍽️', 'れすとらん': '🍽️', 'カフェ': '☕', 'かふぇ': '☕',
    
    // === 交通系 ===
    '車': '🚗', 'くるま': '🚗', '自動車': '🚗', 'じどうしゃ': '🚗',
    'バス': '🚌', 'ばす': '🚌', '電車': '🚆', 'でんしゃ': '🚆',
    '新幹線': '🚄', 'しんかんせん': '🚄', '地下鉄': '🚇', 'ちかてつ': '🚇',
    '飛行機': '✈️', 'ひこうき': '✈️', '船': '🚢', 'ふね': '🚢',
    '自転車': '🚲', 'じてんしゃ': '🚲', 'バイク': '🏍️', 'ばいく': '🏍️',
    'タクシー': '🚕', 'たくしー': '🚕', 'トラック': '🚛', 'とらっく': '🚛',
    
    // === 職業系 ===
    '先生': '👨‍🏫', 'せんせい': '👨‍🏫', '教師': '👨‍🏫', 'きょうし': '👨‍🏫',
    '医者': '👨‍⚕️', 'いしゃ': '👨‍⚕️', '看護師': '👩‍⚕️', 'かんごし': '👩‍⚕️',
    '警察': '👮', 'けいさつ': '👮', '消防士': '👨‍🚒', 'しょうぼうし': '👨‍🚒',
    'エンジニア': '👨‍💻', 'えんじにあ': '👨‍💻', 'プログラマー': '👨‍💻', 'ぷろぐらまー': '👨‍💻',
    'デザイナー': '👨‍🎨', 'でざいなー': '👨‍🎨', 'アーティスト': '👨‍🎨', 'あーてぃすと': '👨‍🎨',
    'シェフ': '👨‍🍳', 'しぇふ': '👨‍🍳', 'コック': '👨‍🍳', 'こっく': '👨‍🍳',
    'パイロット': '👨‍✈️', 'ぱいろっと': '👨‍✈️', '宇宙飛行士': '👨‍🚀', 'うちゅうひこうし': '👨‍🚀',
    
    // === 身体・人体系 ===
    '顔': '😊', 'かお': '😊', '頭': '🧠', 'あたま': '🧠', '脳': '🧠', 'のう': '🧠',
    '目': '👁️', 'め': '👁️', '鼻': '👃', 'はな': '👃', '口': '👄', 'くち': '👄',
    '耳': '👂', 'みみ': '👂', '手': '✋', 'て': '✋', '足': '🦵', 'あし': '🦵',
    '心臓': '❤️', 'しんぞう': '❤️', '血': '🩸', 'ち': '🩸', '骨': '🦴', 'ほね': '🦴',
    '筋肉': '💪', 'きんにく': '💪', '歯': '🦷', 'は': '🦷',
    
    // === 物・道具系 ===
    '本': '📖', 'ほん': '📖', '鉛筆': '✏️', 'えんぴつ': '✏️', 'ペン': '🖊️', 'ぺん': '🖊️',
    '紙': '📄', 'かみ': '📄', 'ノート': '📓', 'のーと': '📓',
    '電話': '📞', 'でんわ': '📞', 'スマホ': '📱', 'すまほ': '📱',
    'カメラ': '📷', 'かめら': '📷', 'テレビ': '📺', 'てれび': '📺',
    'パソコン': '💻', 'ぱそこん': '💻', 'コンピューター': '💻', 'こんぴゅーたー': '💻',
    'お金': '💰', 'かね': '💰', '財布': '👛', 'さいふ': '👛',
    '時計': '⏰', 'とけい': '⏰', '鍵': '🔑', 'かぎ': '🔑',
    'カバン': '👜', 'かばん': '👜', 'リュック': '🎒', 'りゅっく': '🎒',
    '傘': '☂️', 'かさ': '☂️', 'メガネ': '👓', 'めがね': '👓',
    
    // === 時間系 ===
    '朝': '🌅', 'あさ': '🌅', '昼': '☀️', 'ひる': '☀️',
    '夕方': '🌆', 'ゆうがた': '🌆', '夜': '🌃', 'よる': '🌃',
    '深夜': '🌙', 'しんや': '🌙', '明け方': '🌅', 'あけがた': '🌅',
    '今日': '📅', 'きょう': '📅', '明日': '📅', 'あした': '📅',
    '昨日': '📅', 'きのう': '📅', '週末': '📅', 'しゅうまつ': '📅',
    
    // === 色系 ===
    '赤': '🔴', 'あか': '🔴', '青': '🔵', 'あお': '🔵',
    '黄色': '🟡', 'きいろ': '🟡', '緑': '🟢', 'みどり': '🟢',
    '紫': '🟣', 'むらさき': '🟣', 'オレンジ': '🟠', 'おれんじ': '🟠',
    '白': '⚪', 'しろ': '⚪', '黒': '⚫', 'くろ': '⚫',
    '茶色': '🟤', 'ちゃいろ': '🟤', 'ピンク': '🩷', 'ぴんく': '🩷',
    
    // === その他・記号系 ===
    'ハート': '❤️', 'はーと': '❤️', '星': '⭐', 'ほし': '⭐',
    '王冠': '👑', 'おうかん': '👑', 'ダイヤ': '💎', 'だいや': '💎',
    '電気': '⚡', 'でんき': '⚡', '電球': '💡', 'でんきゅう': '💡',
    '爆発': '💥', 'ばくはつ': '💥', '魔法': '✨', 'まほう': '✨',
    'チェック': '✅', 'ちぇっく': '✅', 'バツ': '❌', 'ばつ': '❌',
    '質問': '❓', 'しつもん': '❓', '感嘆符': '❗', 'かんたんふ': '❗'
};

// フォールバック絵文字
const fallbackEmoji = '❓🤔';

// DOM要素の取得
const searchInput = document.getElementById('searchInput');
const searchButton = document.getElementById('searchButton');
const resultDisplay = document.getElementById('result');
const actionButtons = document.getElementById('actionButtons');
const copyButton = document.getElementById('copyButton');
const shareButton = document.getElementById('shareButton');
const notification = document.getElementById('notification');
const notificationText = document.getElementById('notificationText');

// 検索機能
function searchEmojis(inputText) {
    if (!inputText.trim()) {
        return '';
    }
    
    // スペースで区切ってキーワードを分割
    const keywords = inputText.trim().split(/\s+/);
    
    // 各キーワードに対応する絵文字を検索
    const emojis = keywords.map(keyword => {
        const normalizedKeyword = keyword.toLowerCase();
        return emojiDictionary[normalizedKeyword] || fallbackEmoji;
    });
    
    return emojis.join(' ');
}

// 検索実行とUI更新
function performSearch() {
    const inputText = searchInput.value;
    
    if (!inputText.trim()) {
        resultDisplay.textContent = '';
        hideActionButtons();
        return;
    }
    
    // ローディング表示
    resultDisplay.textContent = '検索中...';
    resultDisplay.className = 'result-display loading';
    hideActionButtons();
    
    // 少し遅延を入れてローディング感を演出
    setTimeout(() => {
        const result = searchEmojis(inputText);
        resultDisplay.textContent = result;
        resultDisplay.className = 'result-display';
        
        // 結果がある場合はアクションボタンを表示
        if (result) {
            showActionButtons();
        }
    }, 300);
}

// イベントリスナーの設定
searchButton.addEventListener('click', performSearch);

// エンターキーでの検索
searchInput.addEventListener('keypress', function(event) {
    if (event.key === 'Enter') {
        performSearch();
    }
});

// 入力フィールドにフォーカスを当てる
window.addEventListener('load', function() {
    searchInput.focus();
});

// 入力クリア機能（オプション）
searchInput.addEventListener('input', function() {
    if (this.value === '') {
        resultDisplay.textContent = '';
        resultDisplay.className = 'result-display';
        hideActionButtons();
    }
});

// === 新機能: コピー・シェア機能 ===

// アクションボタンの表示/非表示
function showActionButtons() {
    actionButtons.style.display = 'flex';
    setTimeout(() => {
        actionButtons.classList.add('visible');
    }, 50);
}

function hideActionButtons() {
    actionButtons.classList.remove('visible');
    setTimeout(() => {
        actionButtons.style.display = 'none';
    }, 300);
}

// 通知機能
function showNotification(message, type = 'success') {
    notificationText.textContent = message;
    notification.className = `notification ${type}`;
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.classList.add('show');
    }, 50);
    
    // 3秒後に自動で非表示
    setTimeout(() => {
        hideNotification();
    }, 3000);
}

function hideNotification() {
    notification.classList.remove('show');
    setTimeout(() => {
        notification.style.display = 'none';
    }, 300);
}

// コピー機能
async function copyToClipboard() {
    const text = resultDisplay.textContent;
    
    if (!text || text === '検索中...') {
        showNotification('コピーできる絵文字がありません', 'error');
        return;
    }
    
    try {
        // Clipboard API を試行
        if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(text);
            showNotification('絵文字をコピーしました! 📋');
            
            // ボタンアニメーション
            copyButton.classList.add('clicked');
            setTimeout(() => {
                copyButton.classList.remove('clicked');
            }, 300);
            
            // 一時的にボタンテキストを変更
            const originalText = copyButton.innerHTML;
            copyButton.innerHTML = '✅ コピー済み';
            setTimeout(() => {
                copyButton.innerHTML = originalText;
            }, 2000);
            
        } else {
            // フォールバック: 古いブラウザ対応
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            const successful = document.execCommand('copy');
            document.body.removeChild(textArea);
            
            if (successful) {
                showNotification('絵文字をコピーしました! 📋');
            } else {
                throw new Error('コピーに失敗しました');
            }
        }
    } catch (error) {
        console.error('コピーエラー:', error);
        showNotification('コピーに失敗しました', 'error');
    }
}

// シェア機能
async function shareContent() {
    const emojis = resultDisplay.textContent;
    const inputText = searchInput.value;
    
    if (!emojis || emojis === '検索中...') {
        showNotification('シェアできる絵文字がありません', 'error');
        return;
    }
    
    const shareText = `「${inputText}」→ ${emojis}`;
    const shareUrl = window.location.href;
    
    try {
        // Web Share API を試行（モバイル対応）
        if (navigator.share) {
            await navigator.share({
                title: '絵文字検索アプリ',
                text: shareText,
                url: shareUrl
            });
            showNotification('シェアしました! 📤');
            return;
        }
    } catch (error) {
        console.log('Web Share API エラー:', error);
    }
    
    // フォールバック: SNS個別シェア
    showShareMenu();
}

// シェアメニューの表示
function showShareMenu() {
    const emojis = resultDisplay.textContent;
    const inputText = searchInput.value;
    const shareText = `「${inputText}」→ ${emojis}`;
    const shareUrl = window.location.href;
    
    // シェアメニューがすでに存在する場合は削除
    const existingMenu = document.querySelector('.share-menu');
    if (existingMenu) {
        existingMenu.remove();
    }
    
    // シェアメニューを作成
    const shareMenu = document.createElement('div');
    shareMenu.className = 'share-menu';
    shareMenu.innerHTML = `
        <a href="https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}" target="_blank" class="share-option">
            🐦 Twitter でシェア
        </a>
        <a href="https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(shareText)}" target="_blank" class="share-option">
            💚 LINE でシェア
        </a>
        <button class="share-option" onclick="copyShareText(\`${shareText.replace(/`/g, '\\`')}\`)">
            📋 テキストをコピー
        </button>
    `;
    
    // シェアボタンの位置に追加
    shareButton.style.position = 'relative';
    shareButton.appendChild(shareMenu);
    
    // 表示アニメーション
    setTimeout(() => {
        shareMenu.classList.add('visible');
    }, 10);
    
    // 3秒後に自動で非表示
    setTimeout(() => {
        if (shareMenu.parentNode) {
            shareMenu.remove();
        }
    }, 5000);
    
    // 他の場所をクリックした時に非表示
    document.addEventListener('click', function hideMenu(event) {
        if (!shareButton.contains(event.target)) {
            if (shareMenu.parentNode) {
                shareMenu.remove();
            }
            document.removeEventListener('click', hideMenu);
        }
    });
}

// シェアテキストのコピー
async function copyShareText(text) {
    try {
        if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(text);
        } else {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
        }
        showNotification('シェア用テキストをコピーしました! 📋');
    } catch (error) {
        showNotification('コピーに失敗しました', 'error');
    }
}

// イベントリスナーの追加
copyButton.addEventListener('click', copyToClipboard);
shareButton.addEventListener('click', shareContent);

// グローバル関数として公開（onclick で使用するため）
window.copyShareText = copyShareText;

// デバッグ用（開発時のみ）
console.log('絵文字検索アプリが読み込まれました');
console.log(`登録されている絵文字の数: ${Object.keys(emojiDictionary).length}`);